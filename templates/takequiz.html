{% extends 'base.html' %}

{% block nav %}
    {% if user.is_authenticated %}
        <p>Hi {{ user.username }}! | <a href="{% url 'dashboard' %}">View your quizzes</a> | <a href="{% url 'createnew' %}">+ New quiz</a> | <a href="{% url 'logout' %}">Log out</a></p>
    {% else %}
    {% endif %}
    {% if quiz.author == request.user and request.user.is_authenticated %}
    <p><a href="{% url 'quizresponses' quiz.pk %}">View {{ quiz.quizresponse_set.count }} responses</a></p>
    <p><a href="{% url 'quizreview' quiz.pk %}">Review this quiz</a></p>
    {% endif %}
{% endblock nav %}

{% block content %}

<h1>{{ quiz.title }}</h1>
<h3>Directions and introductory text:</h3>
<p>{{ quiz.directions_and_introductory_text }}</p>
<h3>Primary source text:</h3>
<p>{{ quiz.primary_source_text }}</p>

<form action="{% url 'quiztake' quiz_id=quiz.id %}" method="post">
    {% csrf_token %}
    {{ quiz_response_form.as_p }}
    {{ question_response_formset.management_form }}
    {% for form, question in questions_and_responses %}
    <h3>Question {{ forloop.counter }}</h3>
    <h4>{{ question.question_text }}</h4>
    {{ form.as_p }}
    {% endfor %}
<input type="submit" value="Save" />
</form>
{% endblock content %}